@startuml Manage_Accounts_Activity

' ============================================================
' ACTIVITY DIAGRAM DESCRIPTION
' ============================================================
' Use Case: UC02 - Manage Accounts
' Actor: User
' Includes: UC01 - Authenticate User
' Goal: Allow user to add, edit, and delete financial accounts
'
' STEPS (mapped to actions in diagram):
' Step 1: User requests Account Management (<<include>> UC01)
' Step 2: System verifies user is authenticated
' Step 3: If not authenticated, redirect to Login
' Step 4: System loads User's FinancialAccount list
' Step 5: System displays Account List Screen
' Step 6: User selects action (Add/Edit/Delete)
' Step 7 (Add): System displays Add Account Form
' Step 8 (Add): User enters account details (nickname, type, institution)
' Step 9 (Add): System validates input data
' Step 10 (Add): If invalid, display errors and user corrects data
' Step 11 (Add): System creates FinancialAccount entity
' Step 12 (Edit): User selects account to edit
' Step 13 (Edit): System displays Edit Form with current data
' Step 14 (Edit): User modifies and submits changes
' Step 15 (Edit): System validates and updates FinancialAccount
' Step 16 (Delete): User selects account to delete
' Step 17 (Delete): System displays confirmation dialog
' Step 18 (Delete): If confirmed, system deletes FinancialAccount
' Step 19: System displays success message
' Step 20: System refreshes account list
' ============================================================

title Activity Diagram: UC02 - Manage Accounts

skinparam backgroundColor white
skinparam shadowing false
skinparam ActivityBackgroundColor #E3F2FD
skinparam ActivityBorderColor #1976D2
skinparam ActivityDiamondBackgroundColor #FFF3E0
skinparam ActivityDiamondBorderColor #F57C00

|User|
start

:Request Account Management;
note right
  Step 1
  <<include>> UC01
  Authenticate User
end note

|System|
:Verify User Authenticated;
note right: Step 2

if (Authenticated?) then (yes)
    :Load User's FinancialAccount List;
    note right: Step 4
    
    :Display Account List Screen;
    note right: Step 5
    
    |User|
    :Select Action;
    note right: Step 6
    
    switch (Action Type?)
    
    case (Add Account)
        |System|
        :Display Add Account Form;
        note right: Step 7
        
        |User|
        repeat
            :Enter Account Details;
            note right
              Step 8
              - Nickname
              - Account Type
              - Institution
            end note
            
            :Submit Form;
            
            |System|
            :Validate Input Data;
            note right: Step 9
            
            if (Data Valid?) then (no)
                :Display Validation Errors;
                note right: Step 10
                |User|
            endif
            
        repeat while (Data Invalid?) is (yes)
        
        |System|
        :Create FinancialAccount Entity;
        note right: Step 11
        
        :Link to User;
        
    case (Edit Account)
        |User|
        :Select Account to Edit;
        note right: Step 12
        
        |System|
        :Display Edit Form with Current Data;
        note right: Step 13
        
        |User|
        repeat
            :Modify Account Details;
            note right: Step 14
            
            :Submit Changes;
            
            |System|
            :Validate Updated Data;
            
            if (Data Valid?) then (no)
                :Display Validation Errors;
                |User|
            endif
            
        repeat while (Data Invalid?) is (yes)
        
        |System|
        :Update FinancialAccount Entity;
        note right: Step 15
        
    case (Delete Account)
        |User|
        :Select Account to Delete;
        note right: Step 16
        
        |System|
        :Display Confirmation Dialog;
        note right: Step 17
        
        |User|
        if (Confirm Delete?) then (yes)
            |System|
            :Delete FinancialAccount Entity;
            note right: Step 18
        else (no)
            |System|
            :Cancel Operation;
        endif
        
    endswitch
    
    |System|
    :Display Success Message;
    note right: Step 19
    
    :Refresh Account List;
    note right: Step 20
    
    |User|
    :View Updated Account List;
    
    stop
    
else (no)
    :Redirect to Login;
    note right: Step 3
    stop
endif

@enduml
